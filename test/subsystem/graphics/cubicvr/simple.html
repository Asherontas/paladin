<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
    
    <head>
        <script src="../../../../lib/CubicVR.js" type="text/javascript"></script>
        <script src="../../../../src/paladin.js" type="text/javascript"></script>
        <script src="../../../../src/subsystem/paladin.js" type="text/javascript"></script>
        <script src="../../../../src/subsystem/paladin.subsystem.js" type="text/javascript"></script>
        <script src="../../../../src/subsystem/graphics/paladin.subsystem.graphics.cubicvr.js" type="text/javascript"></script>
        <script type="text/javascript">

          document.addEventListener('DOMContentLoaded', function (e) {

            function Game() {
              var paladin = this.paladin = new Paladin(),
                  gfx = paladin.Subsystem.start("graphics");

              var scene = new gfx.Scene( { fov: 60 } ),
                  camera = new gfx.Camera( { position: [1, 1, 1], target: [0, 0, 0] } ),
                  mesh = new gfx.Mesh({ 
                          primitives: [{
                            type: 'box',
                            size: 0.5,
                            material: {
                              color: [1, 0, 0],
                            },
                          }],
                          finalize: true,
                        }),
                  obj1 = new gfx.SceneObject( { mesh: mesh, name: 'test1' } ),
                  obj2 = new gfx.SceneObject( { mesh: mesh, name: 'test2' } );

              scene.bindCamera(camera);
              scene.bindSceneObject(obj1);
              scene.bindSceneObject(obj2);

              Paladin.tasker.add({
                callback: function( task ) {
                  obj1.rotation[1] = task.time/10;
                  obj1.rotation[2] = 50*Math.sin(task.time/500);
                  return task.CONT;
                },
                name: "rotate object"
              });

              Paladin.tasker.add({
                callback: function( task ) {
                  var i = task.time/2000;
                  obj2.position = [Math.sin(i), Math.cos(i*3), Math.cos(i)];
                  return task.CONT;
                },
                name: "rotate object"
              });

              this.run = function () {
                gfx.pushScene(scene, {
                  update: function ( timer, gl ) {
                    //for shaders and stuff
                  },
                });
                paladin.run();
              };
            };

            var game = new Game();
            game.run();

          }, false);

        </script>
    </head>   
    
    <body>
    </body>
    
</html>
